<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Test Set9 Simple</title>
<style>
html, body {
  margin:0; padding:0;
  width:100%; height:100%;
  background:black;
  overflow:hidden;
}
#glitchCanvas {
  position:absolute;
  top:0; left:0;
  width:100%; height:100%;
  background:black;
}
#special {
  position:absolute;
  top:0; left:0;
  width:100%; height:100%;
  object-fit:cover;
  display:none; /* invisible au départ */
  z-index:10;   /* par dessus tout */
}
</style>
</head>
<body>
<canvas id="glitchCanvas"></canvas>
<img id="special" src="images/set9special.jpg">

<audio id="audio" src="sons/test.mp3" loop></audio>

<script>
const canvas = document.getElementById("glitchCanvas");
const ctx = canvas.getContext("2d");
canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

let clickCount = 0;
let running = true;

// charger une image "set9 normale"
const img = new Image();
img.src = "images/set9.jpg";

img.onload = () => {
  drawLoop();
};

function drawLoop() {
  if (!running) return; // stop si on arrête tout
  ctx.clearRect(0,0,canvas.width,canvas.height);
  
  // petit effet visuel "glitch" simulé
  ctx.filter = `contrast(${100 + Math.random()*50}%)`;
  ctx.drawImage(img,0,0,canvas.width,canvas.height);
  
  requestAnimationFrame(drawLoop);
}

// démarrage audio
const audio = document.getElementById("audio");
audio.play().catch(e=>console.log("Audio bloqué par le navigateur"));

document.body.addEventListener("click", ()=>{
  clickCount++;

  if(clickCount === 46){
    // stop boucle & audio
    running = false;
    ctx.clearRect(0,0,canvas.width,canvas.height);
    audio.pause();
    audio.currentTime = 0;

    // affiche l’image spéciale
    document.getElementById("special").style.display = "block";
    console.log("set9special affichée sans effets !");
  }
});
</script>
</body>
</html>
